{{define "sidebar"}}
<div class="flex flex-col h-full">
    <!-- Logo -->
    <div class="flex items-center h-16 px-4 border-b border-gray-200 dark:border-border-dark">
        <a href="/" class="flex items-center space-x-3">
            <span class="material-symbols-outlined text-primary text-3xl">kitchen</span>
            <span class="font-bold text-xl text-gray-900 dark:text-white" x-show="sidebarOpen" x-transition>KWS</span>
        </a>
    </div>

    <!-- Navigation -->
    <nav class="flex-1 mt-6 px-3 overflow-y-auto">
        <div class="space-y-1">
            {{template "nav-item" dict "href" "/" "icon" "dashboard" "label" "Dashboard" "active" (eq .CurrentPage "dashboard")}}
            {{template "nav-item" dict "href" "/tenants" "icon" "business" "label" "Tenants" "active" (eq .CurrentPage "tenants")}}
            {{template "nav-item" dict "href" "/sites" "icon" "location_on" "label" "Sites" "active" (eq .CurrentPage "sites")}}
            {{template "nav-item" dict "href" "/kos" "icon" "devices" "label" "KOS Instances" "active" (eq .CurrentPage "kos")}}
        </div>

        <div class="mt-8">
            <h3 class="px-3 text-xs font-semibold text-text-secondary uppercase tracking-wider" x-show="sidebarOpen">
                Operations
            </h3>
            <div class="mt-3 space-y-1">
                {{template "nav-item" dict "href" "/recipes" "icon" "menu_book" "label" "Recipes" "active" (eq .CurrentPage "recipes")}}
                {{template "nav-item" dict "href" "/ingredients" "icon" "inventory_2" "label" "Ingredients" "active" (eq .CurrentPage "ingredients")}}
                {{template "nav-item" dict "href" "/orders" "icon" "receipt_long" "label" "Orders" "active" (eq .CurrentPage "orders")}}
            </div>
        </div>

        <div class="mt-8">
            <h3 class="px-3 text-xs font-semibold text-text-secondary uppercase tracking-wider" x-show="sidebarOpen">
                Settings
            </h3>
            <div class="mt-3 space-y-1">
                {{template "nav-item" dict "href" "/settings" "icon" "settings" "label" "Settings" "active" (eq .CurrentPage "settings")}}
                {{template "nav-item" dict "href" "/audit" "icon" "history" "label" "Audit Log" "active" (eq .CurrentPage "audit")}}
            </div>
        </div>
    </nav>

    <!-- Collapse toggle -->
    <div class="p-3 border-t border-gray-200 dark:border-border-dark">
        <button @click="sidebarOpen = !sidebarOpen"
                class="w-full flex items-center justify-center p-2 rounded-lg text-text-secondary hover:bg-gray-100 dark:hover:bg-surface-highlight transition-colors">
            <span class="material-symbols-outlined" x-text="sidebarOpen ? 'chevron_left' : 'chevron_right'"></span>
        </button>
    </div>
</div>
{{end}}

{{define "nav-item"}}
<a href="{{.href}}"
   class="flex items-center py-2.5 rounded-lg text-sm font-medium transition-colors
          {{if .active}}bg-primary/10 text-primary dark:bg-primary/20 dark:text-white
          {{else}}text-gray-600 hover:bg-gray-100 dark:text-text-secondary dark:hover:bg-surface-highlight dark:hover:text-white{{end}}"
   :class="sidebarOpen ? 'px-3' : 'justify-center px-2'"
   title="{{.label}}">
    <span class="material-symbols-outlined text-xl shrink-0 {{if .active}}text-primary{{end}}">{{.icon}}</span>
    <span class="ml-3" x-show="sidebarOpen" x-transition>{{.label}}</span>
</a>
{{end}}
