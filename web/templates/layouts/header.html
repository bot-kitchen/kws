{{define "header"}}
<header class="h-16 bg-white dark:bg-surface-dark border-b border-gray-200 dark:border-border-dark flex items-center justify-between px-6">
    <!-- Left side -->
    <div class="flex items-center space-x-4">
        <h1 class="text-xl font-semibold text-gray-900 dark:text-white">
            {{block "page-title" .}}Dashboard{{end}}
        </h1>
    </div>

    <!-- Right side -->
    <div class="flex items-center space-x-4">
        <!-- Tenant Selector -->
        {{if gt .TenantCount 0}}
        <div class="relative" x-data="{ open: false }">
            <button @click="open = !open"
                    class="flex items-center space-x-2 px-3 py-2 rounded-lg border border-gray-300 dark:border-border-dark bg-gray-50 dark:bg-surface-highlight hover:bg-gray-100 dark:hover:bg-border-dark transition-colors">
                <span class="material-symbols-outlined text-primary text-lg">business</span>
                <span class="text-sm font-medium text-gray-700 dark:text-text-primary">
                    {{if .SelectedTenantName}}{{.SelectedTenantName}}{{else}}Select Tenant{{end}}
                </span>
                <span class="material-symbols-outlined text-text-secondary text-lg">expand_more</span>
            </button>

            <div x-show="open"
                 @click.away="open = false"
                 x-transition
                 class="absolute left-0 mt-2 w-64 bg-white dark:bg-surface-dark rounded-lg shadow-lg border border-gray-200 dark:border-border-dark py-2 z-50">
                <div class="px-4 py-2 border-b border-gray-200 dark:border-border-dark">
                    <h3 class="text-xs font-semibold text-text-secondary uppercase tracking-wider">Switch Tenant</h3>
                </div>
                <div class="max-h-64 overflow-y-auto">
                    {{range .AllTenants}}
                    <form action="/tenants/{{.ID}}/select" method="POST" class="block">
                        <button type="submit"
                                class="w-full flex items-center px-4 py-2 text-sm hover:bg-gray-50 dark:hover:bg-surface-highlight {{if eq .ID $.SelectedTenantID}}bg-primary/10 dark:bg-primary/20{{end}}">
                            <div class="w-8 h-8 rounded-lg bg-primary/10 dark:bg-primary/20 flex items-center justify-center mr-3">
                                <span class="material-symbols-outlined text-primary text-sm">business</span>
                            </div>
                            <div class="text-left">
                                <p class="font-medium text-gray-900 dark:text-white">{{.Name}}</p>
                                <p class="text-xs text-text-secondary">{{.Code}}</p>
                            </div>
                            {{if eq .ID $.SelectedTenantID}}
                            <span class="material-symbols-outlined text-primary ml-auto">check</span>
                            {{end}}
                        </button>
                    </form>
                    {{end}}
                </div>
                {{if .SelectedTenantID}}
                <div class="border-t border-gray-200 dark:border-border-dark mt-2 pt-2 px-4">
                    <form action="/tenants/clear/select" method="POST">
                        <button type="submit" class="flex items-center text-sm text-text-secondary hover:text-white">
                            <span class="material-symbols-outlined text-sm mr-2">close</span>
                            View all tenants
                        </button>
                    </form>
                </div>
                {{end}}
            </div>
        </div>
        {{end}}

        <!-- Search -->
        <div class="relative">
            <input type="text"
                   placeholder="Search..."
                   class="w-64 pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-border-dark bg-gray-50 dark:bg-surface-highlight text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-primary focus:border-transparent placeholder-gray-400 dark:placeholder-text-secondary">
            <span class="material-symbols-outlined absolute left-3 top-2.5 text-gray-400 dark:text-text-secondary">search</span>
        </div>

        <!-- Dark mode toggle -->
        <button @click="toggleDarkMode()"
                class="p-2 rounded-lg text-gray-500 dark:text-text-secondary hover:bg-gray-100 dark:hover:bg-surface-highlight transition-colors">
            <span class="material-symbols-outlined" x-text="darkMode ? 'light_mode' : 'dark_mode'"></span>
        </button>

        <!-- Notifications -->
        <div class="relative" x-data="{ open: false }">
            <button @click="open = !open"
                    class="relative p-2 rounded-lg text-gray-500 dark:text-text-secondary hover:bg-gray-100 dark:hover:bg-surface-highlight transition-colors">
                <span class="material-symbols-outlined">notifications</span>
                <span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"></span>
            </button>

            <div x-show="open"
                 @click.away="open = false"
                 x-transition
                 class="absolute right-0 mt-2 w-80 bg-white dark:bg-surface-dark rounded-lg shadow-lg border border-gray-200 dark:border-border-dark py-2 z-50">
                <div class="px-4 py-2 border-b border-gray-200 dark:border-border-dark">
                    <h3 class="font-semibold text-gray-900 dark:text-white">Notifications</h3>
                </div>
                <div class="max-h-64 overflow-y-auto">
                    <div class="px-4 py-3 hover:bg-gray-50 dark:hover:bg-surface-highlight cursor-pointer">
                        <p class="text-sm text-gray-900 dark:text-white">KOS instance sf-downtown is offline</p>
                        <p class="text-xs text-text-secondary mt-1">2 minutes ago</p>
                    </div>
                    <div class="px-4 py-3 hover:bg-gray-50 dark:hover:bg-surface-highlight cursor-pointer">
                        <p class="text-sm text-gray-900 dark:text-white">New order received for NYC site</p>
                        <p class="text-xs text-text-secondary mt-1">5 minutes ago</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- User menu -->
        <div class="relative" x-data="{ open: false }">
            <button @click="open = !open"
                    class="flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-surface-highlight transition-colors">
                <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center text-white font-medium">
                    {{if .User}}{{slice .User.Name 0 1}}{{else}}A{{end}}
                </div>
                <span class="material-symbols-outlined text-text-secondary">expand_more</span>
            </button>

            <div x-show="open"
                 @click.away="open = false"
                 x-transition
                 class="absolute right-0 mt-2 w-48 bg-white dark:bg-surface-dark rounded-lg shadow-lg border border-gray-200 dark:border-border-dark py-2 z-50">
                <a href="/profile" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-text-secondary hover:bg-gray-100 dark:hover:bg-surface-highlight dark:hover:text-white">
                    <span class="material-symbols-outlined mr-2 text-lg">person</span>
                    Profile
                </a>
                <a href="/settings" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-text-secondary hover:bg-gray-100 dark:hover:bg-surface-highlight dark:hover:text-white">
                    <span class="material-symbols-outlined mr-2 text-lg">settings</span>
                    Settings
                </a>
                <hr class="my-2 border-gray-200 dark:border-border-dark">
                <a href="/logout" class="flex items-center px-4 py-2 text-sm text-red-500 hover:bg-gray-100 dark:hover:bg-surface-highlight">
                    <span class="material-symbols-outlined mr-2 text-lg">logout</span>
                    Logout
                </a>
            </div>
        </div>
    </div>
</header>
{{end}}
